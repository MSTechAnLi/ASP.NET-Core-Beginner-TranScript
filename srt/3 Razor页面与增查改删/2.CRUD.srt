1
00:00:01,043 --> 00:00:07,059
Hey friends, we're glad you're still with us here at Microsoft Virtual Academy as we do our intro to ASP.NET Core.

2
00:00:07,123 --> 00:00:08,595
We're learning all about razor pages and our application.

3
00:00:08,595 --> 00:00:09,683
This module will be a little longer.

4
00:00:09,875 --> 00:00:12,371
Yes it will.

5
00:00:12,371 --> 00:00:15,571
And it will probably have us making some mistakes together,and that's okay.

6
00:00:15,635 --> 00:00:19,219
And we're gonna try not to hide anything from you.

7
00:00:19,219 --> 00:00:24,339
We are following the documentation as we hope that are, and maybe you can follow along.

8
00:00:24,339 --> 00:00:27,987
Pause, try stuff out, and maybe Google with Bing.

9
00:00:28,051 --> 00:00:28,883
Google with Bing.

10
00:00:28,883 --> 00:00:30,547
If you have trouble and get stuck.

11
00:00:30,547 --> 00:00:34,323
Yeah, and we will have links to the documentation right underneath this recording.

12
00:00:34,323 --> 00:00:39,200
All right, so we're gonna try to make a CRUD page.

13
00:00:39,200 --> 00:00:41,000
What is CRUD?

14
00:00:41,081 --> 00:00:45,777
Create,read, update, delete.

15
00:00:45,777 --> 00:00:54,675
All right, so a CRUD application maps verbs from CRUD to verbs that we're used to using,like get is a get, so it would be like a read.

16
00:00:54,675 --> 00:00:57,358
And if you're gonna create something, it would be a post.

17
00:00:57,358 --> 00:01:06,126
So you'd fill out a form, you'd hit submit, and it would post the data, that's a create Then you can maybe read it back and look at in edit page or then maybe delete it.

18
00:01:06,126 --> 00:01:12,718
So if we succeed, we'll have the simple form,maybe create some customers, put them in a fake database And we'll be okay

19
00:01:12,718 --> 00:01:16,878
Yeah, and I will be learning more about databases in the intermediate course as well 

20
00:01:16,878 --> 00:01:18,606
Yes,well like a whole section on databases.

21
00:01:18,606 --> 00:01:20,846
So for now, we're gonna be doing it in an in-memory database.

22
00:01:20,846 --> 00:01:23,598
Okay, so let's do the best we can.

23
00:01:23,598 --> 00:01:26,862
We're gonna use the same web application one that we created before.

24
00:01:26,862 --> 00:01:36,206
We saw in the previous modules where we added MVC, but of course all of that stuff was added for us because we went File > New Project,and we picked Web Application, all right?

25
00:01:36,206 --> 00:01:44,782
So here in configure services, we've got AddMvc.

26
00:01:44,782 --> 00:01:48,430
But we're gonna make our little in-memory database here.

27
00:01:48,430 --> 00:01:53,358
We're gonna say services.AddDbContext<>

28
00:01:53,358 --> 00:01:55,150
Yeah, and give it name

29
00:01:55,150 --> 00:01:58,030
And we gonna create a thing called AppDbContext.

30
00:01:58,030 --> 00:01:59,630
We can name it whatever we want to.

31
00:01:59,630 --> 00:02:02,638
We haven't written this yet, but we will.

32
00:02:02,638 --> 00:02:05,902
I'm gonna hit Ctrl+dot.

33
00:02:05,902 --> 00:02:10,382
And it's saying, hey, do you need an AppDbContext?

34
00:02:10,382 --> 00:02:12,878
Do you wanna go and generate one of those?

35
00:02:12,878 --> 00:02:14,670
I wanna go ahead and say yes.

36
00:02:14,670 --> 00:02:18,190
So it's gone and done that, and we'll deal with that in a minute.

37
00:02:18,190 --> 00:02:22,414
And again, I will very likely make mistakes, so you'll bear with me I hope.

38
00:02:22,414 --> 00:02:27,214
I opened up the parentheses there.

39
00:02:27,214 --> 00:02:28,942
And I'm gonna pass in some options.

40
00:02:28,942 --> 00:02:35,470
- And the option I'm gonna pass in for my database context are options -UseInmemory.

41
00:02:35,470 --> 00:02:37,966
-Use -In.

42
00:02:38,670 --> 00:02:40,270
MemoryDatabase.

43
00:02:40,462 --> 00:02:43,406
Yes, but the reason why that's not showing,that perfect.

44
00:02:43,406 --> 00:02:44,942
-We need to add -why is that not showing up?

45
00:02:44,942 --> 00:02:47,806
So we need to add the entity framework.

46
00:02:47,806 --> 00:02:49,150
So we need to use

47
00:02:49,150 --> 00:02:51,006
And I probably should have added that first, and

48
00:02:51,006 --> 00:02:52,158
I would have gotten IntelliSense.

49
00:02:52,158 --> 00:02:53,758
-True -Let's try that.

50
00:02:53,758 --> 00:02:56,254
If we go back up to the top.

51
00:03:00,222 --> 00:03:02,590
So we add the EntityFrameworkCore beforehand.

52
00:03:02,590 --> 00:03:11,614
Look, you see that little arrow there that's pointing down?

53
00:03:11,614 --> 00:03:19,166
That means that this method came in was included by the fact that we just did that UseIn.

54
00:03:19,166 --> 00:03:21,918
That's called an extension method.

55
00:03:21,918 --> 00:03:23,070
It's along for the ride.

56
00:03:23,070 --> 00:03:24,734
And you see it actually says extension.

57
00:03:24,734 --> 00:03:26,334
That wasn't there seconds ago.

58
00:03:26,334 --> 00:03:27,614
No, it wasn't.

59
00:03:27,934 --> 00:03:37,406
Add InMemoryDatabase, some name All right,And then we look at the squiggle and we worry.

60
00:03:37,406 --> 00:03:39,582
Does the squiggle mean something?

61
00:03:40,542 --> 00:03:43,550
So, here it's saying AddDbContext.

62
00:03:43,550 --> 00:03:45,598
Well, we never really went and did anything with that AddDbContext.

63
00:03:45,598 --> 00:03:46,750
Let's go over there and fix that.

64
00:03:46,750 --> 00:03:48,158
I'm gonna right click and say go to definition.

65
00:03:48,158 --> 00:03:51,294
And let's work on our database context.

66
00:03:51,294 --> 00:03:55,134
This is kind of standard stuff, so don't worry about it too much.

67
00:03:55,134 --> 00:03:58,206
But basically this is representing the database.

68
00:03:59,486 --> 00:04:01,278
I'm hitting Ctrl+dot there.

69
00:04:01,278 --> 00:04:04,542
And I'll say make it an AppDbContext,

70
00:04:04,542 --> 00:04:09,406
this is an constructor, all right?

71
00:04:09,406 --> 00:04:14,078
Okay, and we're gonna take in some options.

72
00:04:17,790 --> 00:04:18,686
ContextOptions.

73
00:04:18,750 --> 00:04:21,438
-Oops, optoons -Options.

74
00:04:21,438 --> 00:04:24,126
Options, pass up to the base class those options.

75
00:04:24,126 --> 00:04:25,534
I'm gonna put that.

76
00:04:25,534 --> 00:04:33,150
What I'm trying to zoom and make it helpful for you, I end up making it worse for myself.

77
00:04:34,238 --> 00:04:36,990
Well, at least you have other people in mind.

78
00:04:37,438 --> 00:04:41,278
-I do. And then -You have to set it of some sort.

79
00:04:41,278 --> 00:04:45,054
We have a set of, we're gonna say customers?

80
00:04:45,118 --> 00:04:46,684
So we have a set of customer.

81
00:04:46,684 --> 00:04:47,900
Customer does not exist here.

82
00:04:47,900 --> 00:04:49,576
That's why it's squiggled out.

83
00:04:50,075 --> 00:04:54,393
And then we do a getter, setter, get ; set, okay?

84
00:04:54,648 --> 00:04:56,248
Customer is squiggled out.

85
00:04:56,248 --> 00:04:59,192
The type or namespace 'Customer' could not be found.

86
00:04:59,192 --> 00:05:01,560
Well, that's true cuz we haven't made one yet.

87
00:05:01,624 --> 00:05:02,648
We had not made it up.

88
00:05:02,648 --> 00:05:06,424
l could type control dot, but l am gonna click show potential fixes.

89
00:05:06,424 --> 00:05:08,664
This is kind of interesting.

90
00:05:08,664 --> 00:05:11,224
Here it's saying, well, I can go and make customer for you.

91
00:05:11,224 --> 00:05:12,696
But look at this here.

92
00:05:12,696 --> 00:05:18,392
It's suggesting other packages that have the word customer and the name customer in it.

93
00:05:18,392 --> 00:05:21,784
So these are other NuGet packages,packages up in the world.

94
00:05:21,784 --> 00:05:22,744
Yeah, ain't that cool?

95
00:05:22,744 --> 00:05:23,448
That's very cool.

96
00:05:23,448 --> 00:05:26,275
-Package out there that has the word customer in it -Has the word customer in it

97
00:05:26,275 --> 00:05:27,102
No, I don't want those.

98
00:05:27,800 --> 00:05:37,464
But if I was doing something with JSON or doing something with some technology that I knew I will need the NuGet packages, later it will go get it for me.

99
00:05:37,464 --> 00:05:40,792
So I'm gonna say generate in new file, that seems reasonable.

100
00:05:40,792 --> 00:05:43,800
-It does -All right, this generated that.

101
00:05:43,800 --> 00:05:45,528
Now notice it just appeared.

102
00:05:46,025 --> 00:05:52,225
-There it is -And now I'm gonna right click and say go to definition

103
00:05:52,516 --> 00:05:56,975
It is worth pointing out that I could also right click and say Peak Definition.

104
00:05:56,975 --> 00:06:00,130
-And could you write in there? -I could.

105
00:06:00,130 --> 00:06:01,225
I think that would be a little weird.

106
00:06:01,499 --> 00:06:10,300
But then I can click on this little tab right here Promote to Document, and now I've jumped into that document.

107
00:06:10,300 --> 00:06:16,175
So I can peek and then if I type a little bit,I was like this is tiresome, then I could jump even higher.

108
00:06:16,175 --> 00:06:17,757
-That's pretty smooth. -It is pretty smooth.

109
00:06:17,821 --> 00:06:21,405
-All right, I'll show you another smooth tip. -I know it.

110
00:06:21,405 --> 00:06:24,413
-Yeah? You wanna suggest? -The tab tab thing?

111
00:06:24,413 --> 00:06:27,741
-Yes, ready? -Prop Tab.

112
00:06:27,741 --> 00:06:35,196
-Tab, tab -int Tab Id Enter Enter prop Tab Tab string Enter Tab Name.

113
00:06:36,325 --> 00:06:40,480
-How cool is that? -It's cool, and I always forget to use it.

114
00:06:40,480 --> 00:06:43,296
-You gotta use it. -I always forget to use it and it's awesome.

115
00:06:43,296 --> 00:06:46,880
-There's so much good stuff in there. -There's also propfull.

116
00:06:46,880 --> 00:06:50,080
-What does that do? -That gives you a backing variable.

117
00:06:50,080 --> 00:06:58,550
There's propa,which I don't know what it does but it's crazy.

118
00:06:58,825 --> 00:07:02,400
There's propg for a getter with a private setter.

119
00:07:02,440 --> 00:07:04,488
Yeah, a bunch of stuff.

120
00:07:04,488 --> 00:07:07,624
-Have you done a blog post on all the properties 

121
00:07:07,624 --> 00:07:10,312
There's a bunch of snippets,I could go all day.

122
00:07:10,312 --> 00:07:12,680
But I'm just gonna use prop for now.

123
00:07:12,680 --> 00:07:16,584
So this is customer, so customers have an ID,a unique ID.

124
00:07:16,584 --> 00:07:18,184
And they have a name.

125
00:07:18,184 --> 00:07:20,552
And they could probably have an email,they could have all these things.

126
00:07:20,552 --> 00:07:24,392
-Yeah. -We'll start with name for now, but should name have some constraints?

127
00:07:24,392 --> 00:07:28,040
-It should. -We have an idea of data annotation.

128
00:07:28,040 --> 00:07:30,088
There's annotation on that data, yes.

129
00:07:30,088 --> 00:07:33,096
So one of the things is that you probably want someone to enter their name, right?

130
00:07:33,096 --> 00:07:38,408
-We wanna force them. -We wanna force them, so we want to make sure it some sort of required, right?

131
00:07:38,408 --> 00:07:43,656
So required, and I'm putting that as a notation here and I'm gonna hit Ctrl+dot, again.

132
00:07:43,656 --> 00:07:50,696
When you learn that these things exist and you're thinking about them rather than typing in all this stuff for the using,you're just gonna type required.

133
00:07:50,696 --> 00:07:54,600
Hit Ctrl+dot, and then hit Enter.

134
00:07:54,600 --> 00:08:00,296
Line 1 just appeared there And then we'll force the length as well.

135
00:08:00,296 --> 00:08:05,032
We'll be silly for a moment, we'll say a length of 10.

136
00:08:05,032 --> 00:08:06,824
That's not a very good length.

137
00:08:06,824 --> 00:08:08,104
That is not a good length at all.

138
00:08:08,104 --> 00:08:10,024
But that might allow us to do some validation later.

139
00:08:10,024 --> 00:08:12,072
And then we'll change it to a longer length.

140
00:08:12,072 --> 00:08:15,592
All right, so let's back up for a second and see what we did here.

141
00:08:15,592 --> 00:08:20,520
So we have in our start up an InMemoryDatabase.

142
00:08:20,520 --> 00:08:22,824
Not a SQLserver or a.

143
00:08:22,824 --> 00:08:25,256
Whatever just in memory database.

144
00:08:25,256 --> 00:08:37,401
We have a beginnings of a customer, unique ID and a name Some annotations on it, and then a little class here that's kind of empty.

145
00:08:37,401 --> 00:08:43,850
That is our a list of customers and actually what's customer Singular here.

146
00:08:43,850 --> 00:08:45,578
-Yeah. -That should be customers.

147
00:08:45,578 --> 00:08:51,978
-Okay, because, you have a set. -This is a set of customers.

148
00:08:51,978 --> 00:08:54,474
So the one thing, how are we going to see this information?

149
00:08:54,474 --> 00:09:01,514
Well, we're going to need to probably put some in the database and then,once we have them in the database, list them out.

150
00:09:01,514 --> 00:09:02,922
Like how are we going to visually see it?

151
00:09:02,922 --> 00:09:05,610
Yeah, so there's a bit of a chicken and the egg problem there.

152
00:09:05,610 --> 00:09:09,898
Do we make the listing page first and list them out?

153
00:09:09,898 --> 00:09:12,202
But we really can't cuz we don't have any.

154
00:09:12,202 --> 00:09:13,802
-You don't anything, yeah. -Or we make a create page first.

155
00:09:13,802 --> 00:09:17,194
-So it's CRUD. -We'll do the C first, okay?

156
00:09:17,194 --> 00:09:20,266
-So over in -The pages folder.

157
00:09:20,266 --> 00:09:23,274
Pages, let's do create.

158
00:09:23,274 --> 00:09:26,282
Now, we're not going to say new file like we did before.

159
00:09:26,282 --> 00:09:29,546
No, you're going to create a new Razor Page or if you go to New File.

160
00:09:29,546 --> 00:09:30,954
Let me do that again.

161
00:09:30,954 --> 00:09:34,026
Right click and I have two choices I have new.

162
00:09:34,026 --> 00:09:35,818
-And then. -Page or I can say item.

163
00:09:35,818 --> 00:09:36,650
Yeah, New Item.

164
00:09:36,650 --> 00:09:39,594
And they should be the option to pick Razor Page.

165
00:09:39,594 --> 00:09:43,306
Right, so you got a couple different options here and this is all the different things that you could make.

166
00:09:44,077 --> 00:09:56,685
I'm gonna go and right click and say add Razor page, and I wanna point out that I'm not gonna do it for this because it will be a little bit cheating but after we're all done, first, we make you suffer.

167
00:09:56,685 --> 00:09:59,053
-And then we show you the easy way And then we show you the easy way

168
00:09:59,334 --> 00:10:07,462
We could create that model and say Razor page is using entity framework CRUD, and then it will then scaffold or generate.

169
00:10:07,462 --> 00:10:10,342
-Every single -All the hard parts that we're about to do.

170
00:10:10,342 --> 00:10:16,550
But it's more fun to do, no no,it's more fun to do it ourselves, don't you think?

171
00:10:16,550 --> 00:10:17,958
-All right. -All right, lets do it ourselves.

172
00:10:17,958 --> 00:10:20,006
People can fast forward if they don't like it.

173
00:10:20,006 --> 00:10:24,294
The page name would be create.

174
00:10:24,294 --> 00:10:26,854
Uh-huh, and then we're gonna use a layout, we saw that.

175
00:10:26,854 --> 00:10:31,014
And then, here it says Generate PageModel,that's that code behind of that page model.

176
00:10:31,014 --> 00:10:34,982
We could say no and then do that in line, if we wanted to.

177
00:10:34,982 --> 00:10:36,886
All right. So let's see if that works.

178
00:10:37,590 --> 00:10:39,766
Thinking, thinking, thinking.

179
00:10:39,766 --> 00:10:42,966
We're gonna watch in the right hand side here as create should appear.

180
00:10:42,966 --> 00:10:45,590
And sticking well because it's doing quite a bit of scaffolding.

181
00:10:45,654 --> 00:10:50,902
Well, it's scaffolding up some workforce but it's also gonna build the application to see if it still builds.

182
00:10:50,902 --> 00:10:54,422
And if it's running a scarf-folder.

183
00:10:54,422 --> 00:10:58,262
And scar folder is something that you can go on a nd read about and write your own if you feel like it.

184
00:10:58,262 --> 00:11:00,374
So here we gotta create.

185
00:11:00,374 --> 00:11:03,574
So let's see what we have in there.

186
00:11:03,574 --> 00:11:04,662
Let's see it gives us a page.

187
00:11:04,662 --> 00:11:16,438
It gave us a default model, a title, looks like a header, and then some validation scripts, and then presumably we can just start typing our pages or whatever.

188
00:11:16,438 --> 00:11:18,230
Let's look at the backend.

189
00:11:18,230 --> 00:11:23,478
It made a create model that has a get.

190
00:11:23,478 --> 00:11:26,422
So this is the function that happens when we get stuff.

191
00:11:26,422 --> 00:11:27,254
Okay.

192
00:11:27,254 --> 00:11:30,198
All right, so we're gonna need to make form code.

193
00:11:30,262 --> 00:11:35,510
All right, so form that would have actually just one entry?

194
00:11:35,510 --> 00:11:41,974
Yeah, so we'll say enter your name, figure, all right.

195
00:11:41,974 --> 00:11:44,079
And who knows if this will work, again, we're gonna learn.

196
00:11:44,079 --> 00:11:48,431
Now, this is interesting, noticed that when I typed form Why is it in purple?

197
00:11:48,431 --> 00:12:02,433
Turns purple, so that is a tag helper, this is some related elements that are gonna be on the server for processing so the server knows about purple elements, and ill do some processing of them.

198
00:12:02,433 --> 00:12:12,545
Typically when you're in HTML, you have like a P tag or an image tag or div, and that's just strings that get sent off to the client.

199
00:12:12,929 --> 00:12:22,785
But when we're generating this stuff on the server side,there might be an opportunity for ASP.NET Core to improve it,to change it, to add stuff.

200
00:12:22,785 --> 00:12:24,385
So it knows about form.

201
00:12:24,385 --> 00:12:27,969
Form is a magic tag and we can go and type things like this,you see it says asp colon.

202
00:12:28,033 --> 00:12:33,281
Yeah, so is that indication that that is a tag helper or some sort of action?

203
00:12:33,281 --> 00:12:35,521
Right these things aren't html.

204
00:12:35,521 --> 00:12:36,289
No.

205
00:12:36,289 --> 00:12:37,569
Those are tag helpers.

206
00:12:37,569 --> 00:12:43,265
You'll never see asp hyphen something being sent all the way out to the browser.

207
00:12:43,265 --> 00:12:44,545
These are not HTML.

208
00:12:44,545 --> 00:12:45,953
They're hints to the server.

209
00:12:45,953 --> 00:12:52,225
So if when we run this application, and we go into the F12 tools, we will not see- You shouldn't see those.

210
00:12:52,225 --> 00:12:53,185
Okay. Exactly.

211
00:12:53,185 --> 00:12:58,689
So we're gonna say form, this is gonna be basic method= a,yep see- Okay.

212
00:12:58,689 --> 00:13:02,017
Get, post, put, delete.

213
00:13:02,017 --> 00:13:03,489
We'll say post So we're gonna go and post.

214
00:13:03,489 --> 00:13:05,025
Here's the end of our form.

215
00:13:05,025 --> 00:13:07,201
Say div, name, and then we'll need a text box.

216
00:13:07,201 --> 00:13:09,313
Yep so some sort of input tag.

217
00:13:09,313 --> 00:13:10,273
Yep input.

218
00:13:10,273 --> 00:13:11,617
Now, this is interesting.

219
00:13:11,617 --> 00:13:17,441
We could do an input tag the way we usually do or we could say ASP.NET4.

220
00:13:17,441 --> 00:13:18,401
Okay.

221
00:13:18,401 --> 00:13:22,817
And we're gonna say Customer.Name.

222
00:13:22,817 --> 00:13:23,585
Okay.

223
00:13:23,585 --> 00:13:25,313
See how it's all purple?

224
00:13:25,313 --> 00:13:30,625
That ASP 4 is gonna look at that model, okay?

225
00:13:30,625 --> 00:13:35,425
Now, it's saying here, I don't know what a Customer is.

226
00:13:35,489 --> 00:13:37,441
What's going on with that?

227
00:13:37,441 --> 00:13:38,465
It's never heard of Customer before.

228
00:13:38,875 --> 00:13:40,923
We'll come back and fix that in a second.

229
00:13:40,923 --> 00:13:44,875
Then we'll have an input for submitting that form, okay?

230
00:13:45,087 --> 00:13:48,735
But we have a problem here,where it doesn't know what Customer is.

231
00:13:48,735 --> 00:13:53,875
What is the model for this page?Right, it's the

232
00:13:53,875 --> 00:13:54,687
The Create

233
00:13:54,687 --> 00:13:57,631
CreateModel, so let's go look at that.

234
00:13:57,631 --> 00:13:59,871
Peek into Definition, okay.

235
00:13:59,871 --> 00:14:01,343
I wanna point out how I'm moving around.

236
00:14:01,343 --> 00:14:04,543
I'm right-clicking and saying Go To Definition is also a hotkey for that.

237
00:14:04,543 --> 00:14:11,839
So this is an important reminder, just as a programmer,you don't wanna necessarily find yourself going over and looking around all the files all the time.

238
00:14:11,839 --> 00:14:14,719
You can navigate- To it, right?

239
00:14:14,719 --> 00:14:18,559
To it directly, you can navigate logically, as they say.

240
00:14:18,559 --> 00:14:21,183
-Okay, all right. -Did you?

241
00:14:21,183 --> 00:14:23,871
Cut something out from- Yeah.

242
00:14:23,871 --> 00:14:25,855
-Okay -Great.

243
00:14:25,855 --> 00:14:28,275
-There we go -I cut out CreateModel, thank you.

244
00:14:28,550 --> 00:14:36,725
Right so, our create model is gonna need to know about customers, because that's gonna show up on the page.

245
00:14:36,982 --> 00:14:39,675
So public Customer, that's a type.

246
00:14:40,302 --> 00:14:42,990
-That's a name -You can tell by the color.

247
00:14:42,990 --> 00:14:44,334
It's a little confusing.

248
00:14:44,334 --> 00:14:49,390
But, the property is called Customer, and the type is called Customer.

249
00:14:49,390 --> 00:14:59,822
And, this is going to need that database context,so we are going to make a little Database here.

250
00:14:59,822 --> 00:15:03,982
And this is just being the voice of the person doing this at home.

251
00:15:03,982 --> 00:15:07,950
Why have you made it private read only?

252
00:15:07,950 --> 00:15:09,934
So that's a great point.

253
00:15:09,998 --> 00:15:16,782
I don't want people who get a hold of create model to be poking around and talking directly to the database.

254
00:15:16,782 --> 00:15:21,774
So, it's gonna be private, just for me where me is CreateModel.

255
00:15:21,774 --> 00:15:27,790
And it's read only which means I'm gonna assign it once, and I don't want anyone to touch it after that.

256
00:15:27,790 --> 00:15:28,878
Yeah. Okay.

257
00:15:28,878 --> 00:15:32,590
So I'm making it just for me and making sure I can't mess with it afterwards.

258
00:15:32,590 --> 00:15:34,894
Excellent, excellent question.

259
00:15:34,894 --> 00:15:41,934
So then, we'll make our- CreateModel Our constructor.

260
00:15:43,662 --> 00:15:46,350
And remember how dependency injection works.

261
00:15:46,350 --> 00:15:49,422
We don't make an AppDbContext we ask for one.

262
00:15:49,742 --> 00:15:55,054
We ask for it by putting it in our constructor.

263
00:15:55,118 --> 00:15:57,678
We can have as many of these as we want.

264
00:15:57,678 --> 00:15:58,638
We can have food and bar, etc, etc, etc.

265
00:15:58,638 --> 00:16:00,366
This is the one we want for now.

266
00:16:00,366 --> 00:16:06,766
And then I'm just going to say hey, this one equals this one.

267
00:16:06,766 --> 00:16:10,414
I'm going to squirrel it away and hang onto it, so now I've got one.

268
00:16:10,414 --> 00:16:16,878
So that says there's this database, and I want to know about it.

269
00:16:16,878 --> 00:16:20,206
This says there's a customer.

270
00:16:20,206 --> 00:16:29,934
If I go back over to create, I can hover over that and see it's getting me probably IntelliSense too.

271
00:16:29,934 --> 00:16:31,662
Yep, see. Now, it is.

272
00:16:31,662 --> 00:16:36,654
So, it knows about customer because it's hanging off of the model.

273
00:16:37,870 --> 00:16:40,110
So as we're running the application.

274
00:16:40,110 --> 00:16:45,486
Technically, I should be able to go to this page,hover over customer name and see what names we've put in there?

275
00:16:45,486 --> 00:16:48,942
You should be able to click on that,you should be able to have IntelliSense.

276
00:16:48,942 --> 00:16:54,958
If you did a break point,you should be able to stop in here at some point and look at that, and we'll do that in a little bit.

277
00:16:54,958 --> 00:17:01,422
What we need, though, is we need to bind this form.

278
00:17:01,422 --> 00:17:04,686
We're saying this input for customer name.

279
00:17:04,686 --> 00:17:10,830
When I hit submit, we need to catch it on the server side.

280
00:17:10,830 --> 00:17:13,070
I call it surviving the journey.

281
00:17:13,070 --> 00:17:14,414
Okay. Yeah, it's a good point.

282
00:17:14,414 --> 00:17:15,310
It does need to survive the journey.

283
00:17:15,310 --> 00:17:17,038
So I'm gonna get rid of this OnGet here.

284
00:17:17,038 --> 00:17:18,574
So we're gonna do a post.

285
00:17:19,470 --> 00:17:21,902
You can say OnPost.

286
00:17:22,414 --> 00:17:26,126
You could do it like this but the right way to do it is like this.

287
00:17:26,126 --> 00:17:36,238
-Async? -Async, which means don't block, and we're gonna have a task that returns some action.

288
00:17:36,238 --> 00:17:41,806
We might be doing something after this and I'm gonna say on OnPostAsync.

289
00:17:48,750 --> 00:17:50,885
And it's giving me a little complaint here saying!

290
00:17:51,293 --> 00:17:53,789
You didn't do a wait and you haven't returned a value.

291
00:17:53,789 --> 00:17:59,805
Code paths, not all code paths return a value.

292
00:17:59,805 --> 00:18:01,405
That's cuz we haven't done anything yet.

293
00:18:02,365 --> 00:18:08,125
So, when someone posts back, they hit submit,and it posts back to here.

294
00:18:08,573 --> 00:18:11,709
We would really like customer to have stuff in it.

295
00:18:12,861 --> 00:18:14,845
-Yes -And so there's a couple things here.

296
00:18:14,845 --> 00:18:18,975
And then we need to make sure that the state of that model is valid, that someone hasn't messed with it.

297
00:18:19,450 --> 00:18:30,280
So I'm gonna say if ModelState.IsValid,or if it's not, pardon me- I was about to say something.

298
00:18:30,280 --> 00:18:31,560
No I appreciate that.

299
00:18:31,560 --> 00:18:36,168
Then return the page back to itself to say now I'm done.

300
00:18:36,168 --> 00:18:43,016
If I hover over page you can see it returns a page result,which is a kind of action.

301
00:18:43,016 --> 00:18:44,808
Returning a page is an action.

302
00:18:44,808 --> 00:18:50,696
If we get this far, now I'm gonna say db,remember when I say db?

303
00:18:50,696 --> 00:18:52,040
-Yes -What is db?

304
00:18:52,040 --> 00:18:58,440
It is a applicationDB context.

305
00:18:58,504 --> 00:19:01,832
In there is customers, plural.

306
00:19:01,832 --> 00:19:04,072
-And we want to add one. -.Add().

307
00:19:04,136 --> 00:19:08,040
We'll pass in the customer that we just got handed.

308
00:19:08,104 --> 00:19:13,160
And then we'll say, hang out for a minute, await.

309
00:19:13,160 --> 00:19:17,704
And we'll say, db.SaveChanges.

310
00:19:17,704 --> 00:19:20,328
And async means don't wait.

311
00:19:20,328 --> 00:19:26,152
Then we will go and return,not a page, because we're on the create page.

312
00:19:26,152 --> 00:19:28,264
We really wanna return to the list.

313
00:19:28,264 --> 00:19:29,736
Yeah, so you're doing a redirect?

314
00:19:29,736 --> 00:19:31,976
We're gonna do a redirect, exactly.

315
00:19:31,976 --> 00:19:33,959
And we haven't got a place to go yet.

316
00:19:33,959 --> 00:19:36,264
But we'll say redirect to page.

317
00:19:36,264 --> 00:19:41,675
Okay. And you can see that there's options like redirect to page permanent, which would be a 301.

318
00:19:41,675 --> 00:19:43,437
Http 301.

319
00:19:43,437 --> 00:19:47,925
Okay. We're gonna do a 302 because this is just a standard kind of redirect.

320
00:19:47,925 --> 00:19:49,112
Let's just say /Index.

321
00:19:49,112 --> 00:19:52,988
And I think we should probably just say /,but we'll see what happens.

322
00:19:52,988 --> 00:19:56,999
If people wanted to learn more about 301s,302s, do you have any recommendations?

323
00:19:56,999 --> 00:19:58,983
-The Internet. -Correct

324
00:19:58,983 --> 00:20:01,479
I would search around for that kind of stuff.

325
00:20:01,479 --> 00:20:03,143
Ultimately look at the docs.

326
00:20:03,143 --> 00:20:12,679
Yeah. But redirect to page is a standard thing and again if you hover over it, it says right there Status302Found.

327
00:20:12,679 --> 00:20:18,759
But if I said RedirectToPagePermanent.

328
00:20:18,759 --> 00:20:19,975
We would change it?

329
00:20:19,975 --> 00:20:25,927
Change it to a 301, which would tell the search engine,don't ever come back here and ask me about this again.

330
00:20:25,927 --> 00:20:28,423
Don't ever talk to me again go here.

331
00:20:28,423 --> 00:20:31,879
All right. That's what that means.

332
00:20:31,879 --> 00:20:35,137
I'm paranoid so anyway,you never wanna do that when you're doing database work.

333
00:20:35,137 --> 00:20:37,249
You always wanna be temporary, okay?

334
00:20:37,249 --> 00:20:41,729
Okay. All right, and if you really,really, really wanna upset your coworkers.

335
00:20:41,729 --> 00:20:47,299
You could move your curly braces.

336
00:20:47,299 --> 00:20:48,000
Yeah.

337
00:20:48,475 --> 00:20:50,025
And do stuff like this.

338
00:20:50,627 --> 00:20:57,027
And if you really wanna be possibly buggy,you could even do stuff like this.

339
00:21:00,291 --> 00:21:01,763
Where that's all one line.

340
00:21:01,763 --> 00:21:02,403
Yeah?

341
00:21:02,403 --> 00:21:05,411
But you might have other stuff that you wanna do.

342
00:21:05,411 --> 00:21:08,867
Okay. Some people that really bothers them, some people it doesn't.

343
00:21:08,867 --> 00:21:10,979
For me- Does it bother you?

344
00:21:10,979 --> 00:21:13,731
I kinda like it on one line if it's not that big of a deal.

345
00:21:14,115 --> 00:21:15,587
You know what I mean?

346
00:21:15,587 --> 00:21:20,003
But as soon as you have an extra line then you're gonna go and undo it and take it apart.

347
00:21:20,003 --> 00:21:21,027
It's stylistic.

348
00:21:21,027 --> 00:21:24,227
So it's not really a best practice for someone to know of right now.

349
00:21:24,227 --> 00:21:28,579
No, for right now, I just think it's nice to have everything fit on one line like that.

350
00:21:28,579 --> 00:21:32,227
But using the curly mustaches.

351
00:21:33,250 --> 00:21:37,850
Is curly braces,they look like a mustache if you turn your head.

352
00:21:38,150 --> 00:21:38,933
That's a best practice.

353
00:21:39,475 --> 00:21:43,059
It still gets us, that when people say curly braces, and I don't know what they're talking about

354
00:21:43,059 --> 00:21:43,750
-What do you call them? -cuz I use brackets

355
00:21:43,750 --> 00:21:44,902
You call them brackets?

356
00:21:44,902 --> 00:21:47,278
So you have brackets, curly brackets, square brackets, so.

357
00:21:47,278 --> 00:21:49,600
-Scandalous -Okay

358
00:21:50,094 --> 00:21:52,206
-You're fancy -That is pretty intense.

359
00:21:52,206 --> 00:21:56,814
-Yeah -Okay, now I'm going to put a break point here.

360
00:21:56,814 --> 00:21:59,118
-Okay. And we'll see if this works -All right.

361
00:21:59,118 --> 00:22:01,422
It might very well not work.

362
00:22:01,422 --> 00:22:04,366
Fingers crossed and toes.

363
00:22:04,366 --> 00:22:05,650
No, it's probably not gonna work.

364
00:22:05,650 --> 00:22:07,634
Lower your expectations now.

365
00:22:09,593 --> 00:22:11,257
-All right -Okay.

366
00:22:11,257 --> 00:22:14,457
This is in create, right?

367
00:22:14,457 --> 00:22:16,633
Yep. So I have to hit /create.

368
00:22:23,043 --> 00:22:23,875
-Yeah -Okay

369
00:22:30,787 --> 00:22:33,603
-Okay -Did we bind it?

370
00:22:33,603 --> 00:22:35,715
-Yeah see what's happening? -Nothing.

371
00:22:35,715 --> 00:22:38,339
No. And if we go and do a view source.

372
00:22:38,339 --> 00:22:41,795
-And you go to? -Okay.

373
00:22:41,859 --> 00:22:44,419
I just want to show the people the form first.

374
00:22:48,195 --> 00:22:51,779
Some things showed up on the input that's kinda cool.

375
00:22:55,107 --> 00:22:57,219
-That's kinda nice -That is

376
00:22:57,219 --> 00:22:58,755
We didn't type that, right, remember?

377
00:22:58,755 --> 00:23:03,363
So we're getting stuff on the input that we did not expect,which is cool.

378
00:23:03,427 --> 00:23:05,667
I bet there's some request verification.

379
00:23:05,667 --> 00:23:08,611
Yeah, they put a request verification token to keep people from tampering with our stuff.

380
00:23:08,611 --> 00:23:12,963
There is your name=Customer.Name.

381
00:23:12,963 --> 00:23:15,587
And it generated an id for us as well.

382
00:23:16,355 --> 00:23:18,083
But you can see that nothing's happening.

383
00:23:20,195 --> 00:23:28,140
On Customer, actually I wanna put a break point a little higher up, and then I'll explain to you what's going on.

384
00:23:28,716 --> 00:23:31,020
-Okay -Let's see if we can even get to the post.

385
00:23:33,836 --> 00:23:40,556
Okay, do a debug session again /create.

386
00:23:47,850 --> 00:23:49,414
So I would've expected.

387
00:23:49,798 --> 00:23:51,150
To hit that break point.

388
00:23:51,150 --> 00:23:54,606
To hit that break point, so that's concerning.

389
00:23:57,840 --> 00:24:13,072
But I know that I need to say BindProperty on the customer which is to tell it I want this customer object filled out with the form information, right?

390
00:24:13,072 --> 00:24:15,376
-Yeah. -And right now I don't have that.

391
00:24:17,040 --> 00:24:22,352
So let's take a look, and try this again.

392
00:24:22,352 --> 00:24:31,312
The customer is gonna get created and filled up with information bound to those form fields.

393
00:24:31,312 --> 00:24:44,560
If that doesn't work then I've forgotten something and we will go and have a little debugging which will be fun as well.

394
00:24:46,864 --> 00:24:51,728
They say the definition of insanity is doing the same thing over and over and expecting a different result.

395
00:24:51,728 --> 00:24:54,352
So let's take a look.

396
00:24:54,352 --> 00:24:56,272
It's probably something obvious.

397
00:24:59,408 --> 00:25:01,008
So we've got a form, we've got our input, we've got our method.

398
00:25:04,272 --> 00:25:06,704
I said post, does it matter if it's all caps?

399
00:25:07,856 --> 00:25:09,328
That would be odd if it did.

400
00:25:14,384 --> 00:25:15,792
So it doesn't matter.

401
00:25:17,392 --> 00:25:23,920
The tag helper exists already in view imports,the form is there.

402
00:25:23,920 --> 00:25:28,272
The only thing l didn't add is the validation summary, okay?

403
00:25:37,103 --> 00:25:44,719
-Okay -All right, so l am putting in a long name, Fancy Pants, and nothing's happening.

404
00:25:44,783 --> 00:25:57,625
No. No, and am realizing that I've got my form with my input for customer name,but I put my validation summary outside the form.

405
00:25:57,625 --> 00:26:02,553
-Okay -So I am gonna put it inside the form,cuz it's validating the form.

406
00:26:02,975 --> 00:26:15,519
And then I'm gonna hit Refresh, Fancy Pants, see and it says the Field Name, must be a string with maximum length of 10.

407
00:26:15,519 --> 00:26:20,383
I'm getting that validation for free, right?

408
00:26:20,383 --> 00:26:22,111
And where did that 10 come from?

409
00:26:24,159 --> 00:26:27,871
We set it in, yep, right there.

410
00:26:27,935 --> 00:26:29,279
We set it right there.

411
00:26:29,279 --> 00:26:33,695
So maybe we'll change that to like 25, or something like that.

412
00:26:33,695 --> 00:26:38,495
Some people have really long names like in my country who have names which are 50, so maybe 100?

413
00:26:38,495 --> 00:26:40,991
I'll make 49 and then that one 50 person,they're gonna suffer.

414
00:26:40,991 --> 00:26:45,727
Man, inclusion. But the point is it's driven by- By them.

415
00:26:45,727 --> 00:26:46,623
By them, okay?

416
00:26:46,623 --> 00:26:52,959
And then one other thing- So it'd be the same if someone did entered something that wasn't an email, right?

417
00:26:52,959 --> 00:27:01,279
Yeah, it could be an email, it could be,you can put in validation information however you want,and you could even put in custom, regular expressions, or even write your own custom validators.

418
00:27:01,279 --> 00:27:02,751
So they could be as sophisticated as you want.

419
00:27:02,751 --> 00:27:09,215
-Okay -You could also, I believe, say, I want a span.

420
00:27:09,279 --> 00:27:18,303
And say asp-validation-for, and you could go and do a field by field validation, okay.

421
00:27:18,751 --> 00:27:26,303
So here I'm saying this is my summary of all the different things, this is a specific validation for Customer Name.

422
00:27:27,375 --> 00:27:36,725
Okay, let's see what that looks like And that might look a little different so if I come over here, come back over here and hit Refresh,oops I actually don't hit Refresh.

423
00:27:36,725 --> 00:27:38,700
I need to run my app again cuz I stopped it.

424
00:27:39,875 --> 00:27:40,835
Okay.

425
00:27:43,907 --> 00:27:45,059
Run that again.

426
00:27:48,003 --> 00:27:48,899
Go to Create.

427
00:27:50,051 --> 00:27:52,611
I think we made it really long this time, right?

428
00:27:54,723 --> 00:27:59,651
And I tab away and it says it must be a string with a maximum length of 49.

429
00:28:00,227 --> 00:28:00,675
Okay.

430
00:28:01,443 --> 00:28:07,011
Okay, but I like the main validation stuff so we'll leave that like that, okay?

431
00:28:07,971 --> 00:28:18,723
Now, let's go back to our break points and run our debugger this time, and see if we can see the customer get found.

432
00:28:18,723 --> 00:28:19,491
Okay.

433
00:28:19,491 --> 00:28:29,411
We had looked in the F12 developer tools before,we could see what's happening on the wire.

434
00:28:29,411 --> 00:28:33,315
This is a good way to kinda just see what's happening as you do your posts.

435
00:28:34,339 --> 00:28:37,219
So when you're looking, so you went to Developer Tools.

436
00:28:37,219 --> 00:28:38,243
Yeah. And the network?

437
00:28:38,243 --> 00:28:40,099
I went to dot dot dot Developer Tools and we're under Network.

438
00:28:40,099 --> 00:28:49,315
Okay. I will go and probably and clear it out, and then we'll put in Maria, okay.

439
00:28:51,043 --> 00:28:53,411
Yep, there we go, so if you hover over that.

440
00:28:53,475 --> 00:29:02,051
If we hover over Customer, see,because customer has a name.

441
00:29:02,051 --> 00:29:08,963
Yeah. Customer.name, and we name the field Customer.name, and we told it, hey,bind, we want you to participate.

442
00:29:08,963 --> 00:29:13,763
You automatically showed up in there.

443
00:29:13,763 --> 00:29:15,043
Okay. And I can put a little pin there as well.

444
00:29:15,875 --> 00:29:23,171
If I was gonna do lots of debugging sessions,then I can keep you there as a post to note and watch customer name change over time.

445
00:29:23,171 --> 00:29:24,131
That's a good one.

446
00:29:24,131 --> 00:29:28,400
We can go and see if the model state is valid, it is.

447
00:29:28,881 --> 00:29:33,790
-What is the green button, that's a play like -Yeah, go to that point.

448
00:29:34,400 --> 00:29:37,959
Play up to that point, and then stop.

449
00:29:38,325 --> 00:29:42,574
So here, I'm gonna go and Add that customer to the database.

450
00:29:42,574 --> 00:29:45,646
Save it to the database,which of course is an in-memory database.

451
00:29:45,646 --> 00:29:52,401
And then we'll redirect Now we had put in slash, but I'm not sure that's gonna work.

452
00:29:52,401 --> 00:29:55,473
Should we should we see about their pages, just in case?

453
00:29:55,473 --> 00:29:56,325
-Yeah, see? -Okay.

454
00:29:56,325 --> 00:30:00,677
It's says no page / matches this value.

455
00:30:00,677 --> 00:30:02,252
So you have to give the specific name

456
00:30:02,252 --> 00:30:08,798
 I need to say index, which was what our main page is here

457
00:30:08,798 --> 00:30:10,654
So index, okay?

458
00:30:11,934 --> 00:30:13,662
Now we'll confirm if that that works.

459
00:30:13,726 --> 00:30:22,366
I can hit F5 to go and debug, or I can hit Ctrl+F5,which I like to do, cuz it starts up a little faster,if I know that I'm not gonna do a debugging session.

460
00:30:23,774 --> 00:30:25,118
But this time you hit F5?

461
00:30:25,118 --> 00:30:27,102
I hit Ctrl+F5 to go faster.

462
00:30:28,382 --> 00:30:33,566
Okay, so it redirected me to index but of course I haven't done anything on index that's interesting yet.

463
00:30:33,566 --> 00:30:34,398
Okay.

464
00:30:34,398 --> 00:30:35,294
That will be the next part, right.

465
00:30:35,294 --> 00:30:36,894
So you could also probably send a message saying

466
00:30:36,894 --> 00:30:40,670
I can say customer updated,or whatever.

467
00:30:40,734 --> 00:30:43,486
But let's rip out this whole section here.

468
00:30:43,486 --> 00:30:46,046
-Okay, very nice -And put a list of contents.

469
00:30:46,046 --> 00:30:47,326
-Okay -Is that cool?

470
00:30:47,326 --> 00:30:50,782
So where's our index?

471
00:30:50,782 --> 00:30:54,558
So this is all this carousel and all this stuff.

472
00:30:54,558 --> 00:30:55,902
All the fancy bootstrap.

473
00:30:55,966 --> 00:30:58,910
I'm gonna actually collect this.

474
00:30:58,910 --> 00:31:00,446
And then you comment it out?

475
00:31:00,446 --> 00:31:04,030
Actually, no, I'm just gonna be awesome and just like toss it.

476
00:31:04,094 --> 00:31:12,800
Wow. Yeah, but this is a way,if you wanna go hunting for the other side of the div,you can just fold these up, see that this matches this.

477
00:31:13,769 --> 00:31:17,545
Fold it up, select over it and toss it.

478
00:31:21,001 --> 00:31:22,537
Cool, all right.

479
00:31:22,537 --> 00:31:24,905
So let's make our form.

480
00:31:28,361 --> 00:31:31,433
And this will be on the index page, right?

481
00:31:31,433 --> 00:31:37,425
Yep. We'll have method="post", and this will be a table.

482
00:31:37,900 --> 00:31:39,564
All right.

483
00:31:40,450 --> 00:31:43,721
It's okay to use tables, if it is a table of data.

484
00:31:43,785 --> 00:31:47,650
So many people complain about tables being a bad idea.

485
00:31:48,000 --> 00:31:49,472
I think that's kind of funny.

486
00:31:49,472 --> 00:31:51,328
[LAUGH] It's a table.

487
00:31:51,328 --> 00:31:52,608
It's okay to have a table.

488
00:31:52,608 --> 00:31:56,192
So we'll have a head for our table, and we'll have our ID row.

489
00:31:57,920 --> 00:32:08,096
-Yep -Oops, and we'll have ID.

490
00:32:09,632 --> 00:32:16,352
Then we'll have Name, we don't really need to show the database ID but for now let's show it.

491
00:32:16,992 --> 00:32:17,952
All right.

492
00:32:18,400 --> 00:32:20,896
Is that cool? So do you have to create a tbody, okay yeah,you're way ahead of me.

493
00:32:20,896 --> 00:32:22,048
No, it's okay. Table body

494
00:32:22,048 --> 00:32:26,080
But now I need a row for each.

495
00:32:27,040 --> 00:32:34,528
So would you put it in the row, or would you,so I am presumed that you need to go for every contact within.

496
00:32:34,720 --> 00:32:36,000
Exactly.

497
00:32:36,000 --> 00:32:40,352
So I'm gonna have like a FOR SOMETHING HERE.

498
00:32:40,416 --> 00:32:54,240
Then a couple of cells, table cells, and then maybe a, I don't know,like a link to edit and a delete button.

499
00:32:54,432 --> 00:32:55,264
Yeah.

500
00:32:55,328 --> 00:32:57,952
Okay, you see how I'm kind of sketching it out.

501
00:32:57,952 --> 00:32:59,680
You're sketching it out.

502
00:32:59,680 --> 00:33:00,768
Okay. Wild, what's it called?

503
00:33:00,768 --> 00:33:02,752
Pseudocode or something? Pseudocode.

504
00:33:02,752 --> 00:33:05,696
Yeah. It's a little pseudocode here.

505
00:33:05,696 --> 00:33:07,040
So now I wanna say at.

506
00:33:07,040 --> 00:33:08,896
For each yeah. And this is a snippet-

507
00:33:08,896 --> 00:33:20,096
-Yeah -Tab, Tab, and then I'm gonna say for each,contact, oops, contact in, in what?

508
00:33:20,096 --> 00:33:21,056
In Model.

509
00:33:21,056 --> 00:33:23,232
Now where is our customers?

510
00:33:24,768 --> 00:33:31,104
Okay, so remember before when we were doing our create model?

511
00:33:31,104 --> 00:33:34,752
We needed to have the customers come from somewhere.

512
00:33:34,752 --> 00:33:36,352
Yeah. Now we're in a totally different page.

513
00:33:36,352 --> 00:33:38,464
Yeah, so we have to have the customers.

514
00:33:38,528 --> 00:33:39,680
We have to have the customers, right?

515
00:33:39,680 --> 00:33:42,112
Yeah. So I'm gonna just take a break here.

516
00:33:42,112 --> 00:33:49,472
And I'm gonna jump over to the index model cuz we can't really make our table till we have a little bit more, okay?

517
00:33:49,536 --> 00:33:59,520
And I'm gonna break a couple of cardinal rules that I'm gonna copy paste a little code,because I'm gonna need this similar app database.

518
00:33:59,520 --> 00:34:02,656
This app db context which is gonna save myself a moment of time here.

519
00:34:04,064 --> 00:34:08,736
So we've got our app context, right?

520
00:34:08,736 --> 00:34:10,976
We're gonna have our index page model.

521
00:34:11,360 --> 00:34:15,904
Now before, when we create a customer,we create one customer.

522
00:34:16,288 --> 00:34:24,416
But here our model is different cuz we're gonna have a list of customers on this page, right?

523
00:34:24,416 --> 00:34:25,504
So our model is different.

524
00:34:25,952 --> 00:34:31,136
And we'll do a get and then a private set so that only we can set it.

525
00:34:31,712 --> 00:34:40,736
All right, and then, in the OnGet, We'll say OnGet.

526
00:34:41,312 --> 00:34:42,848
One line below, OnGetAsync, okay.

527
00:34:42,912 --> 00:34:48,480
-OnGetAsync, right? -We're gonna load up customers.

528
00:34:48,480 --> 00:34:49,568
Where do we get them from?

529
00:34:49,696 --> 00:34:51,168
The database and this is right there.

530
00:34:51,296 --> 00:34:53,984
We're getting them out of customers.

531
00:34:53,984 --> 00:35:01,400
And then there's this other little bit of thing that you can add on to make things a little bit faster.

532
00:35:01,400 --> 00:35:05,875
You can say AsNoTracking.

533
00:35:08,808 --> 00:35:11,496
And I'll show you what that means in a second.

534
00:35:11,496 --> 00:35:16,609
And we're gonna turn these customers into a list of customers.

535
00:35:16,609 --> 00:35:19,808
So we're chaining things together,we're saying give me these customers.

536
00:35:20,192 --> 00:35:24,032
And we're not gonna keep track of them changing.

537
00:35:24,032 --> 00:35:28,960
You see it says disabling change tracking is useful for read-only scenarios.

538
00:35:29,024 --> 00:35:37,152
Change tracking is watching like keeping a track of all the different things you could change so that you know how to make a database update.

539
00:35:37,152 --> 00:35:51,040
So if I had a list of customers, and I wanted to watch all of them and change their names, that would give the database system entity framework that we're gonna learn about later all the information it needs about how to only change the bits that change, how to only change the database.

540
00:35:51,040 --> 00:35:58,976
But we're just getting a list, so we're gonna say, don't track these, just give me a list.

541
00:35:58,976 --> 00:36:03,712
So customers, no tracking, give me a list, so that's cool.

542
00:36:04,928 --> 00:36:07,424
And I think we'll leave that like that for now.

543
00:36:07,744 --> 00:36:09,984
We'll go back over to index.

544
00:36:11,968 --> 00:36:17,591
And now that model, the page behind us has customers.

545
00:36:17,591 --> 00:36:20,840
Look, customers shows up, see, which is nice.

546
00:36:21,400 --> 00:36:24,950
So then I think I can put my tr in here.

547
00:36:26,280 --> 00:36:30,120
And I'm hoping, remember, I said contact, I should say customer.

548
00:36:31,848 --> 00:36:43,944
Customer singular, foreach customer,that means that the customer variable is now available to me customer.Id.

549
00:36:46,025 --> 00:36:50,152
-Everything's connected -Yep, cool, let's try that.

550
00:36:50,152 --> 00:36:57,640
Okay. And then we'll do the rest,cuz I don't know if this is gonna work yet.

551
00:36:57,640 --> 00:36:59,496
Now I'm using an in-memory database, so every time I run this, it's gonna go away.

552
00:36:59,496 --> 00:37:01,352
So it's just a throw away database.

553
00:37:01,352 --> 00:37:10,440
-I need to do better -I need to maybe make tests later, and I survived the journey.

554
00:37:10,504 --> 00:37:16,456
-You did -Let's see, but as soon as I shut you down, it's gonna be gone.

555
00:37:16,456 --> 00:37:19,784
So if you refresh the page- You're here,you're still there, right?

556
00:37:19,784 --> 00:37:22,920
You're there until I close it, until I close this browser.

557
00:37:22,920 --> 00:37:27,464
Or not if I close the browser, pardon me,until I stop the web server.

558
00:37:27,464 --> 00:37:33,032
-So, okay -Yeah, thanks, cool, so now we've got create.

559
00:37:33,032 --> 00:37:36,680
We should probably put a button down there at the bottom somewhere.

560
00:37:36,680 --> 00:37:49,224
We've got some validation, we've got our database,looking at our friends And this is doing a thing called Post Redirect Get.

561
00:37:49,224 --> 00:37:54,792
So I'm here, I hit a post, we do a redirect, and then we do a get, and then we would get this stuff here.

562
00:37:54,856 --> 00:37:57,800
So this is a PRG, Post Redirect Get.

563
00:37:57,800 --> 00:38:00,424
There's lots of articles on the Internet about that.

564
00:38:00,488 --> 00:38:05,608
Now let's make a link to theoretically go and edit these things.

565
00:38:05,608 --> 00:38:08,369
-Okay -And then we'll have a button for Delete.

566
00:38:08,369 --> 00:38:11,139
These things don't exist on the backend yet,but we can- So yeah,so we don't have an edit page yet.

567
00:38:11,139 --> 00:38:13,089
-We don't -Okay. We can make a link

568
00:38:13,089 --> 00:38:14,753
Now I could go and put in a link, href.

569
00:38:14,753 --> 00:38:16,161
You've done this before a million times.

570
00:38:16,161 --> 00:38:21,857
And say /edit and then put in strings and stuff.

571
00:38:21,857 --> 00:38:24,289
But remember we talked about how great tag helpers are.

572
00:38:24,289 --> 00:38:34,721
-Yeah -What if we went and said asp-page and then we could go and say there's an edit page and then it would figure out what the URL would look like.

573
00:38:34,721 --> 00:38:40,801
-Okay -All right, and then it could even express the route a certain way.

574
00:38:40,801 --> 00:38:44,385
And we'll talk about routes in a minute.

575
00:38:46,625 --> 00:38:48,450
I think it's route-id.

576
00:38:51,297 --> 00:38:53,729
And I think we called it customer.Id.

577
00:38:53,729 --> 00:39:01,665
So it's gonna take that customer's id so we want to basically make a page that looks like /edit/2, /edit/3, right?

578
00:39:01,665 --> 00:39:10,369
And that's the route id that's gonna get added onto that.

579
00:39:10,369 --> 00:39:13,761
Okay, so the next thing you have is a button?

580
00:39:13,761 --> 00:39:22,465
Yeah, we'll do a button type="submit" and this is going to be handled by the page.

581
00:39:22,465 --> 00:39:25,409
-Okay -Button's gonna be a little different.

582
00:39:25,409 --> 00:39:31,937
The reason that we're doing a button in an href is so you can see the difference between a link,and how links behave, and buttons.

583
00:39:31,937 --> 00:39:34,177
A link is gonna navigate somewhere.

584
00:39:34,177 --> 00:39:36,929
-Yep -And a button's gonna cause a post, right?

585
00:39:36,929 --> 00:39:41,665
So this will go and be handled by the delete handler.

586
00:39:41,665 --> 00:39:48,705
But we also need that route information, we need that id because we're gonna delete a particular customer.

587
00:39:48,705 --> 00:39:49,985
So you need the content ID, yep.

588
00:39:49,985 --> 00:39:50,945
Customer ID, exactly.

589
00:39:51,009 --> 00:39:54,913
All right, and then none of this is hooked up.

590
00:39:54,977 --> 00:40:00,481
So you mentioned something, voice of the people at home,about the button being a post.

591
00:40:00,481 --> 00:40:11,041
Yes, it is going to post back and then we're gonna need to handle that behavior differently than the Create page.

592
00:40:11,041 --> 00:40:13,601
So then I'll just put a link at the bottom there for Create.

593
00:40:13,601 --> 00:40:14,881
So I'm just gonna hit Refresh.

594
00:40:14,881 --> 00:40:20,065
So let's see if the Create- Here's our Create.

595
00:40:21,153 --> 00:40:21,793
Okay.

596
00:40:21,857 --> 00:40:22,689
That still works.

597
00:40:22,689 --> 00:40:25,057
Okay. I hover over that.

598
00:40:25,057 --> 00:40:28,449
Nothing's happening because we don't have an edit.

599
00:40:28,449 --> 00:40:33,505
We never made an edit page, and I hit Delete You should.

600
00:40:33,505 --> 00:40:37,665
It's gonna crash cuz it's like I don't know what you're doing, right?

601
00:40:37,857 --> 00:40:43,125
It's just in the middle of something and it's confused cuz that's not what I asked it to do.

602
00:40:44,125 --> 00:40:46,225
Okay, so we've got some fixing up to do.

603
00:40:46,225 --> 00:40:51,460
-Let's try Delete first -Okay. All right, so let's go over here.

604
00:40:51,460 --> 00:40:58,450
-We made an OnGet -Let's go and make an OnDelete.

605
00:40:58,450 --> 00:41:08,932
-Okay -Same thing as before with an IActionResult, except now we're gonna say on and this is kinda weird, OnPostDelete.

606
00:41:09,764 --> 00:41:20,964
The verb delete is a real HTTP verb,but it's not really often used from a browser's perspective.

607
00:41:20,964 --> 00:41:25,700
It's usually done as it's piggybacked on post.

608
00:41:25,700 --> 00:41:29,732
We use post to pass in basically all kinds of information.

609
00:41:29,732 --> 00:41:34,980
Whenever we hit Submit on a form, we're posting that form.

610
00:41:34,980 --> 00:41:38,884
We're adding in, I think we said, page-handler delete.

611
00:41:39,140 --> 00:41:43,492
So that is gonna be here, OnPostDelete.

612
00:41:44,388 --> 00:41:53,092
And now we're going to say,a customer, customer singular.

613
00:41:53,092 --> 00:41:56,484
And we'll go and get that customer out of the database.

614
00:41:57,550 --> 00:42:04,600
Before we delete it we gotta go and get it to make sure it's there,I say find, by that ID that got passed in.

615
00:42:05,709 --> 00:42:10,314
So now we gotta check to see if that customer's null or not, cuz if it's null, then we don't even bother.

616
00:42:10,634 --> 00:42:12,746
If it's not null, do something.

617
00:42:14,410 --> 00:42:17,354
And then we can go and Redirect.

618
00:42:17,674 --> 00:42:18,442
To a page.

619
00:42:18,634 --> 00:42:20,362
To a page, exactly, thank you.

620
00:42:20,490 --> 00:42:24,138
So here, we're gonna remove it from the database.

621
00:42:24,138 --> 00:42:32,983
And we are doing it in a memory database but it doesn't matter because if it was a regular database it would remove it for us, as well, that's what's nice about any framework.

622
00:42:33,495 --> 00:42:34,775
I'm not a very good typer.

623
00:42:35,927 --> 00:42:43,543
So we remove the customer and then we go and we save those changes.

624
00:42:46,935 --> 00:42:51,159
-Okay -And then I would expect it would then redirect to the page,the same page.

625
00:42:51,159 --> 00:42:56,598
Yes. And I would expect that it would disappear from that list because it's going to go back to the database and build the list again.

626
00:42:57,150 --> 00:42:59,646
-Does that make sense? -It does, it sure does.

627
00:42:59,646 --> 00:43:01,182
I think that's what it will do.

628
00:43:03,038 --> 00:43:05,022
So we cross our fingers and hope that it works.

629
00:43:07,646 --> 00:43:08,926
And if it doesn't, we learn.

630
00:43:10,334 --> 00:43:15,291
-Okay -That's not a good name.

631
00:43:20,600 --> 00:43:22,050
All right, we're deleting you.

632
00:43:22,050 --> 00:43:24,059
Okay, I'm fine with that.

633
00:43:24,400 --> 00:43:26,256
It does work the way you want.

634
00:43:26,256 --> 00:43:27,536
Yeah, it does work

635
00:43:27,536 --> 00:43:28,808
-Fire, fire, fire -Deal, deal, deal.

636
00:43:29,525 --> 00:43:32,700
-Fancy pants -But now if we edit it.

637
00:43:32,700 --> 00:43:35,644
Doesn't work because Edit doesn't exist.

638
00:43:35,644 --> 00:43:36,796
And it is not there.

639
00:43:36,796 --> 00:43:38,268
All right, so let's go and do edit, then.

640
00:43:38,268 --> 00:43:43,196
So we'll do what you said before, add razor page.

641
00:43:44,860 --> 00:43:50,172
Call it Edit, now I know you like routing.

642
00:43:50,172 --> 00:43:52,604
Routing is one of your favorite things about ASP.NET.

643
00:43:52,604 --> 00:44:00,284
So this Edit page is gonna be the first time that we've ever had a page that took in information.

644
00:44:00,284 --> 00:44:03,548
-Okay -Where does that go to pass in the ID?

645
00:44:04,124 --> 00:44:10,076
-So up there at page? -Right, quote quotes.

646
00:44:10,076 --> 00:44:11,932
Yeah, and curly brackets.

647
00:44:11,932 --> 00:44:15,575
-Yeah -ID.

648
00:44:15,575 --> 00:44:16,919
I mean int.

649
00:44:16,919 --> 00:44:19,378
Okay so the ID is of type int.

650
00:44:19,378 --> 00:44:21,042
Yes. That's the type hint.

651
00:44:21,675 --> 00:44:25,030
So this is saying edit slash 3.

652
00:44:25,030 --> 00:44:27,782
So you'd see it in the browser,that's what it would look like.

653
00:44:27,782 --> 00:44:28,425
Okay.

654
00:44:28,742 --> 00:44:36,125
We have our Edit model, and then here, at the top, we might have Edit, we could actually add a little bit of text here.

655
00:44:36,125 --> 00:44:37,341
We could say Edit Customer.

656
00:44:38,493 --> 00:44:41,373
And then we could say- Dash Model?

657
00:44:41,373 --> 00:44:46,045
@Model.Customer, but again, we're not getting IntelliSense,why not?

658
00:44:46,045 --> 00:44:49,693
Because the page model is different for each page.

659
00:44:49,693 --> 00:44:50,589
Exactly.

660
00:44:50,589 --> 00:44:54,621
So let's go look at the one for Edit.

661
00:45:00,125 --> 00:45:01,789
So I'm gonna.

662
00:45:01,789 --> 00:45:02,855
-You're gonna take, yeah -Borrow again

663
00:45:03,648 --> 00:45:13,440
Certainly I could make another class, a base class, that would pull that AppDBContext in so I wouldn't have to keep copy-pasting that because at some point the copy-pasting becomes tedious.

664
00:45:15,875 --> 00:45:18,688
And you want to keep it dry, right.

665
00:45:18,688 --> 00:45:20,224
Don't repeat yourself.

666
00:45:21,632 --> 00:45:23,488
You probably want that to survive the journey right?

667
00:45:23,488 --> 00:45:24,448
Yeah.

668
00:45:24,448 --> 00:45:25,088
Okay.

669
00:45:25,088 --> 00:45:31,168
So we want to survive the journey,with bindproperty, okay.

670
00:45:32,512 --> 00:45:38,336
So I go back over to our page, and let's see if that worked.

671
00:45:39,552 --> 00:45:40,832
And it did, that's nice.

672
00:45:40,832 --> 00:45:41,856
Yes, it did.

673
00:45:41,856 --> 00:45:51,200
So now we can say, we are Model.Customer.Id, so we can say, Edit Customer for, or whatever.

674
00:45:52,925 --> 00:45:59,840
And then form, and then a form post, and there's some lots of cool ways to make your forms easier to write.

675
00:45:59,840 --> 00:46:06,179
If you find writing forms tedious, there's a really great way to write forms that is called Emmet.

676
00:46:07,325 --> 00:46:09,123
-What is Emmet? -You've never heard of Emmet?

677
00:46:09,450 --> 00:46:14,122
E-m-m-e-t, it's like the name, the person's name Emmet.

678
00:46:14,122 --> 00:46:20,027
Okay. And it's a way of describing what you want like a feel like trt.

679
00:46:20,027 --> 00:46:30,091
TR TD times three and then you'd hit tab and then it would go and expand it, it's a way to write tags for HTML really really fast.

680
00:46:30,091 --> 00:46:37,046
-Is it built in? -It's built into Visual Studio code but it is not built in to Visual Studio yet.

681
00:46:37,174 --> 00:46:41,270
-Okay -Notice how I got this here, soon as I said ASP net four.

682
00:46:41,270 --> 00:46:44,662
Yeah, it gave you [CROSSTALK] Input four, rather.

683
00:46:44,662 --> 00:46:46,774
It got that, this is really nice, right?

684
00:46:46,838 --> 00:46:52,342
So I can go and fill out these forms really quickly and I don't have to worry about that's gonna happen on the server side.

685
00:46:52,918 --> 00:46:58,294
Okay, so then we'll say a label, and this is a label also for.

686
00:46:58,294 --> 00:46:59,574
The customer.

687
00:46:59,574 --> 00:47:10,518
Customer's name which is nice and then we'll say, give you another div, And then within there we'll have an input.

688
00:47:10,582 --> 00:47:15,638
For Customer.Name.

689
00:47:18,134 --> 00:47:20,374
And then you can do the validation again, right?

690
00:47:20,374 --> 00:47:26,646
Yeah I'll do some, but I can do validation two different ways.

691
00:47:26,646 --> 00:47:27,926
I could do the validation summary or we can do it like this, which is nice.

692
00:47:27,926 --> 00:47:30,166
And what are the key differences?

693
00:47:30,166 --> 00:47:32,854
This one is, you have total control of what it looks like.

694
00:47:32,854 --> 00:47:34,710
You can put it anywhere up or down.

695
00:47:34,710 --> 00:47:37,846
Okay. And this is just a bulleted list that's a roll up.

696
00:47:37,846 --> 00:47:39,702
Okay. Of all of the stuff.

697
00:47:39,702 --> 00:47:42,262
Totally up to you how you wanna do things.

698
00:47:44,182 --> 00:47:46,934
This is all inside of a form, right?

699
00:47:46,934 --> 00:47:48,150
So you want to save it, right?

700
00:47:48,150 --> 00:47:51,094
Yeah, we're going to need a save button.

701
00:47:53,526 --> 00:48:04,598
-Exactly -So we'll put our button at the bottom,and it's just a regular old submit, nothing fancy about it.

702
00:48:04,662 --> 00:48:05,430
And it'll say save.

703
00:48:05,430 --> 00:48:06,454
We're going to want to load this up and save it.

704
00:48:06,454 --> 00:48:07,606
And have validation.

705
00:48:07,606 --> 00:48:14,070
We've done all that very nicely like this, and we just wanna confirm like you said on the backend that we do the right thing.

706
00:48:14,070 --> 00:48:17,270
So on the get, actually let's do this.

707
00:48:17,270 --> 00:48:20,598
Let's run it first and then we'll try it again because right now we haven't hooked anything up.

708
00:48:20,598 --> 00:48:22,838
We haven't got it from the database we haven't updated from the database.

709
00:48:22,838 --> 00:48:25,206
But I would expect the links to at least work.

710
00:48:25,206 --> 00:48:29,366
Yeah. Cuz now there is an Edit page.

711
00:48:31,670 --> 00:48:33,846
If there's not, then maybe I forgot something.

712
00:48:34,294 --> 00:48:36,342
Okay, look in the corner there.

713
00:48:36,470 --> 00:48:39,798
-Okay -It's kind of hard for me to do that.

714
00:48:39,798 --> 00:48:45,558
I can take a screenshot but I can't really take a screenshot.

715
00:48:45,622 --> 00:48:48,502
-Let's do this -We'll take a snipping tool.

716
00:48:49,526 --> 00:48:51,894
Give it a delay of two seconds.

717
00:48:52,982 --> 00:48:55,478
You're that fast? I am.

718
00:48:59,638 --> 00:49:07,382
So Edit/1 right,so the route got built by the fact that it was in the Edit.

719
00:49:07,382 --> 00:49:09,878
And then you had added that ID at the top there.

720
00:49:09,878 --> 00:49:17,174
So this is nice because we didn't have to hard code what a link looked like.

721
00:49:17,174 --> 00:49:18,326
That's really important.

722
00:49:18,326 --> 00:49:22,358
We said, make me a link that takes me here.

723
00:49:22,358 --> 00:49:25,814
We didn't say make me a link that looks like this.

724
00:49:25,814 --> 00:49:26,902
Nope.

725
00:49:26,902 --> 00:49:27,670
That's nice.

726
00:49:27,670 --> 00:49:31,638
And if we changed our things later, then it would change for us, which is nice.

727
00:49:31,638 --> 00:49:37,142
So here,if I click on that, I assume it'll just do, yeah, nothing.

728
00:49:37,142 --> 00:49:40,086
So it's like, blegh, I don't have anything there.

729
00:49:40,086 --> 00:49:47,638
It doesn't know about customer yet because we have the bind,but we never loaded the customers.

730
00:49:47,638 --> 00:49:56,982
So let's go and do our stuff again, we're gonna have our action result and here we're gonna say OnGet, of course,int id, that's gonna get passed in automatically because of the way we set up our routes, that's nice.

731
00:49:56,982 --> 00:50:14,710
By default, will just return to page, but here we'll say Customer, the one above Go and get it from the database.

732
00:50:14,710 --> 00:50:23,542
And find it, okay, Yeah, so FindAsync, kind of a standard thing, you could pass in more complicated queries, and get it other ways.

733
00:50:23,542 --> 00:50:24,566
If it's null, freak out.

734
00:50:24,566 --> 00:50:31,926
-Right? -Yeah. If (Customers == null),I don't know, let's put them back to index.

735
00:50:31,926 --> 00:50:34,486
It's Customer, right?

736
00:50:34,550 --> 00:50:36,534
Yes, pardon me, Customer.

737
00:50:38,646 --> 00:50:54,390
Okay, RedirectToPage("/Index"); a lot of typing,but we don't wanna hide anything from you.

738
00:50:54,454 --> 00:50:55,670
Keeping it 100.

739
00:50:55,670 --> 00:51:05,398
We are absolutely keeping it 100,so this should that up and give us a form, with the customer in it.

740
00:51:06,806 --> 00:51:10,966
Let's see if it does, cuz we added that bind property,which you said, what did you call it?

741
00:51:10,966 --> 00:51:11,664
Surviving the journey.

742
00:51:11,664 --> 00:51:13,584
Surviving the journey.

743
00:51:14,875 --> 00:51:16,929
You saw that interest movie really survive the journey.

744
00:51:16,929 --> 00:51:18,337
Don't tell me what happens at the end?

745
00:51:18,337 --> 00:51:18,850
So I've been.

746
00:51:18,850 --> 00:51:19,810
I don't wanna know.

747
00:51:19,810 --> 00:51:21,090
Okay, and then I hit Edit, and then it works.

748
00:51:21,090 --> 00:51:22,308
Exactly. Right.

749
00:51:22,308 --> 00:51:25,874
-So what happens if you change it around? -If I change it

750
00:51:25,874 --> 00:51:30,610
probably nothing Right,cuz we don't have our post.

751
00:51:30,610 --> 00:51:31,225
Exactly.

752
00:51:31,225 --> 00:51:33,050
Exactly, so we've got our get.

753
00:51:34,834 --> 00:51:40,146
But we don't have our post.

754
00:51:40,146 --> 00:51:42,322
You could kind of copy that.

755
00:51:42,322 --> 00:51:58,642
Yes, I think there's a way to actually link that whole thing quickly, but we'll say, OnPostAsync All right,the very end we will do that Redirect.

756
00:51:58,642 --> 00:51:59,794
To the index page?

757
00:51:59,794 --> 00:52:01,266
To the index page, exactly.

758
00:52:01,330 --> 00:52:07,538
-Okay -What do we do?

759
00:52:07,538 --> 00:52:09,458
Well, we've got that model state valid issue.

760
00:52:09,458 --> 00:52:11,314
Yeah, so if not model.

761
00:52:11,314 --> 00:52:15,922
Not ModelState.IsValid.

762
00:52:15,986 --> 00:52:17,970
Yeah, we want it to return to the page.

763
00:52:17,970 --> 00:52:23,474
-Okay -Aah, Page

764
00:52:23,474 --> 00:52:28,338
See, if you try to type too fast to impress people, and it just ends up making you look silly.

765
00:52:28,402 --> 00:52:31,538
Okay, now this one is an interesting one.

766
00:52:31,538 --> 00:52:33,074
Cuz you want to attach it to the database.

767
00:52:33,074 --> 00:52:36,914
Yeah, so what we're doing is,we're modifying something that's all ready in the database.

768
00:52:36,978 --> 00:52:41,586
So what we're trying to do is take this customer that we are recurrently editing.

769
00:52:41,586 --> 00:52:43,506
So it's in a cart state.

770
00:52:43,506 --> 00:52:53,554
Attach that customer in the state of it in the database,we're going to mark that as Modified.

771
00:52:53,554 --> 00:52:54,770
And this bit here.

772
00:52:54,770 --> 00:52:56,370
It shouldn't be there, yeah.

773
00:52:56,370 --> 00:53:00,466
Add the using statement, there we go.

774
00:53:00,530 --> 00:53:02,898
And now it's turned blue, okay.

775
00:53:02,898 --> 00:53:12,562
Now, we don't know if it's going to work, because someone else could be simultaneously editing at the same time.

776
00:53:12,562 --> 00:53:13,586
Exactly, so you want to do a try and catch.

777
00:53:13,586 --> 00:53:16,530
Can do a try, maybe it'll work, maybe it won't.

778
00:53:16,530 --> 00:53:24,530
And the exception that we're gonna catch for,is called aDbUpdateConcurrencyException.

779
00:53:24,530 --> 00:53:26,130
So just in case someone's doing-

780
00:53:26,130 --> 00:53:27,922
If someone's in there at the same time- Exactly what it says.

781
00:53:27,922 --> 00:53:31,383
Exactly what it is. Okay, so you're going to wait for changes?

782
00:53:31,383 --> 00:53:38,675
Go on 'await' and say SaveChangesAsync, and presumably that'll work fine.

783
00:53:39,200 --> 00:53:41,819
If it doesn't- We'll have to throw an exception?

784
00:53:41,819 --> 00:53:50,027
Now there's different arguments about the right way to do this, but for now I'm gonna go and say, Customer, and this is kind of cool.

785
00:53:50,411 --> 00:53:54,750
Customer.Id, see how I'm getting IntelliSense inside the string?

786
00:53:59,000 --> 00:54:04,047
We can do whatever we want to about that concurrency exception, maybe even pass it in as an inner exception.

787
00:54:04,047 --> 00:54:10,831
But the fact is, actually, that would be a good idea,we'll pass that in, along for the ride.

788
00:54:12,687 --> 00:54:16,591
We wanna give a message to somebody that bad stuff has happened.

789
00:54:17,807 --> 00:54:23,631
All right,that should be, I think we always gonna create only.

790
00:54:23,631 --> 00:54:26,383
-And we do -We've done the create.

791
00:54:27,599 --> 00:54:29,903
-Let's go see -I think the create was a post.

792
00:54:29,903 --> 00:54:33,359
-Yeah -The read is the for loop.

793
00:54:34,127 --> 00:54:39,695
The delete was also a post, but with a delete sidecar,along for the ride.

794
00:54:40,399 --> 00:54:48,591
-So, Create, Dan -Break points from before.

795
00:54:48,719 --> 00:54:55,759
-Yeah. I will remove those -I think you still have, okay.

796
00:54:55,823 --> 00:54:57,231
Continue, we'll bump into them if we have more.

797
00:54:57,231 --> 00:54:58,895
-Fancy pants -Beyonce.

798
00:54:58,959 --> 00:55:06,703
-That's a good point -Edit

799
00:55:08,687 --> 00:55:11,311
-Carter -Carter Knowles.

800
00:55:14,511 --> 00:55:16,751
-Yeah -Don't get it twisted.

801
00:55:16,815 --> 00:55:22,447
-Delete everyone else who is not worthy -So

802
00:55:22,447 --> 00:55:25,071
-See, it works -It does work.

803
00:55:25,135 --> 00:55:30,063
There you go, taking care of business, cool.

804
00:55:30,063 --> 00:55:34,223
-So, let's think about that -So, that's pretty sweet.

805
00:55:34,223 --> 00:55:41,711
-It is -If we go back, and just kind of review particularly,this bit here we've got our edit.

806
00:55:41,775 --> 00:55:47,471
With the route id where we did not see

807
00:55:47,535 --> 00:55:49,135
-Where are we reaching -out right now?

808
00:55:49,135 --> 00:55:50,863
I'm sorry this is index.

809
00:55:50,863 --> 00:55:52,847
-Okay -Right?

810
00:55:52,847 --> 00:55:56,751
So here we got an edit.

811
00:55:56,815 --> 00:56:06,530
I wanna point out how it looks in the code, and then compare that to how it looks ultimately in the code, right?

812
00:56:06,530 --> 00:56:11,075
When it makes it all the way back to the browser.

813
00:56:13,314 --> 00:56:15,746
-See? -It's in.

814
00:56:15,746 --> 00:56:21,314
So that came from, this seems like a little more.

815
00:56:21,314 --> 00:56:22,338
You might be asking yourself,why you don't just hard code that?

816
00:56:22,338 --> 00:56:25,794
But routes change, pages change, things get moved around..

817
00:56:25,794 --> 00:56:35,650
Now, this one is a little bit more interesting here,because you might have multiple buttons on the page that do different stuff.

818
00:56:35,650 --> 00:56:39,490
So then, you can give them a handler name. Right?

819
00:56:39,490 --> 00:56:40,514
I could have delete.

820
00:56:40,514 --> 00:56:43,778
I could have bold face Beyonce, I could have all caps, right?

821
00:56:43,842 --> 00:56:44,802
We could have whatever.

822
00:56:44,802 --> 00:56:49,026
You're not limited to one button.

823
00:56:49,026 --> 00:56:59,010
A submit button can have, you could have multiple submits,still passing numbers, like in this case id.

824
00:56:59,010 --> 00:57:01,954
-Yeah -And this is an ampersand.

825
00:57:01,954 --> 00:57:06,946
-Yeah -Multiple handlers, delete, promote whatever.

826
00:57:06,946 --> 00:57:08,162
-Save -Save exactly

827
00:57:08,162 --> 00:57:18,530
-Okay -And what's cool about that, is that then that word delete If we look at the behind is this word.

828
00:57:18,530 --> 00:57:27,362
So I think you could even go like on post "foo" async, or whatever, as long as it lines up because you're saying on post and then some handler.

829
00:57:27,362 --> 00:57:29,090
-Yes -That cool?

830
00:57:29,090 --> 00:57:37,026
That is cool. And the handler is literally you could say Let me stop our debugging here.

831
00:57:42,978 --> 00:57:45,090
You gonna try the foo?

832
00:57:46,375 --> 00:57:48,098
Right I can do whatever, it doesn't matter.

833
00:57:48,098 --> 00:57:50,978
That word is totally up to you.

834
00:57:50,978 --> 00:57:53,410
So I don't need to test that.

835
00:57:54,370 --> 00:57:56,738
-You just trust me -You don't trust me?

836
00:57:56,738 --> 00:57:58,466
-Yeah, sure -All right let's test it then.

837
00:57:58,466 --> 00:58:05,890
-Let's test it -That gives you a lot of flexibility with buttons, so I say foo right there.

838
00:58:05,890 --> 00:58:09,154
-I go over here -We say foo.

839
00:58:09,730 --> 00:58:11,138
And there you go.

840
00:58:11,138 --> 00:58:12,034
So while that's loading?

841
00:58:12,034 --> 00:58:13,058
What were you gonna say?

842
00:58:13,058 --> 00:58:15,810
No, no, no, I trust you ish.

843
00:58:15,874 --> 00:58:17,986
-Trust you ish? -Yeah.

844
00:58:17,986 --> 00:58:20,802
That's pretty good, I'll take that.

845
00:58:21,058 --> 00:58:26,498
Let's go and add people.

846
00:58:29,826 --> 00:58:31,554
-Okay -That was foo.

847
00:58:31,554 --> 00:58:33,410
How did f oo know it was delete?

848
00:58:34,178 --> 00:58:38,658
Because it doesn't matter that it was named Foo.

849
00:58:38,722 --> 00:58:40,386
It's just a handler name.

850
00:58:41,218 --> 00:58:50,425
And if we confirm it Did I pass it?

851
00:58:50,882 --> 00:58:52,546
-Nope -This is create, sorry.

852
00:58:55,170 --> 00:58:56,770
There you go there's a delete.

853
00:58:56,770 --> 00:59:00,418
Okay see it says handler equals foo.

854
00:59:00,418 --> 00:59:06,434
-Yes, okay, yes -And then, I just happened to name this handler foo also.

855
00:59:06,434 --> 00:59:12,770
-Yes, yeah -So the point is, it lined up.

856
00:59:12,770 --> 00:59:14,114
And that's how you can have unlimited verbs.

857
00:59:14,114 --> 00:59:17,506
And then at that point, it just did the thing and removed it from the database.

858
00:59:17,634 --> 00:59:26,338
-Cool? -Cool. So,we saw lots of different handlers, like gets and posts, and custom handlers like delete.

859
00:59:26,338 --> 00:59:33,954
-Yeah -We saw some tag helpers, that will generate buttons and links for us.

860
00:59:33,954 --> 00:59:36,322
-We saw layout pages -We saw validation.

861
00:59:36,322 --> 00:59:39,842
We saw validation both summary and individual.

862
00:59:39,842 --> 00:59:45,730
-And yeah -Yeah lots of little bit about routing and a little bit more detail.

863
00:59:45,730 --> 00:59:51,490
We saw routing,and then specifically, actually one important thing we can point out about routing as well.

864
00:59:51,554 --> 01:00:00,578
If I click edit Did we, I shut the app down again.

865
01:00:00,578 --> 01:00:01,858
You had said ID:int

866
01:00:01,858 --> 01:00:09,154
-Yes -Where int was a number, correct?

867
01:00:09,154 --> 01:00:12,418
It would be interesting.

868
01:00:12,418 --> 01:00:19,010
So just confirm that, if we put in Submit Query, edit, she is one.

869
01:00:21,442 --> 01:00:24,322
Put in an ID that is not an int.

870
01:00:24,322 --> 01:00:31,554
You should get a You simply get a 404,you don't get a 500.

871
01:00:31,554 --> 01:00:32,770
It's not an error.

872
01:00:32,770 --> 01:00:33,922
It's a route that doesn't exist.

873
01:00:33,922 --> 01:00:35,778
We don't have an edit that takes a string.

874
01:00:35,778 --> 01:00:43,074
So that's another really,really important thing to point out about routing, and why that little bit up there was so significant?

875
01:00:43,074 --> 01:00:52,226
And then soon, in the intermediate sections, we will learn a little bit more about web APIs, and url, and mixing and matching pages as well Yeah.

876
01:00:52,226 --> 01:00:54,402
Can we take a break and come back with a little bit of logging?

877
01:00:54,402 --> 01:00:55,554
Yes we will

